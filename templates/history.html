<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <title>Indicator History</title>
</head>
<body>
<div class="container mt-5">
    <h2>History of Changes for Indicator ID: {{ histories[0].indicator_ID if histories else '' }}</h2>
    <table class="table">
        <thead>
            <tr>
                <th>Changed At</th>
                <th>Old Name</th>
                <th>New Name</th>
                <th>Old Definition</th>
                <th>New Definition</th>
                <th>Old SPs</th>
                <th>New SPs</th>
                <th>Old EFs</th>
                <th>New EFs</th>
            </tr>
        </thead>
        <tbody>
            {% for record in histories %}
            <tr>
                <td>{{ record.changed_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td>{{ record.old_name }}</td>
                <td>{{ record.new_name }}</td>
                <td>{{ record.old_definition }}</td>
                <td>{{ record.new_definition }}</td>
                <!-- Display SPs and EFs for this record -->
                <td>
                    {% if record.old_SPA %}SPA {% endif %}
                    {% if record.old_SPB %}SPB {% endif %}
                    {% if record.old_SPC %}SPC {% endif %}
                    {% if record.old_SPD %}SPD {% endif %}
                    {% if record.old_SPE %}SPE {% endif %}
                    {% if record.old_SPF %}SPF {% endif %}
                </td>
                <td>
                    {% if record.new_SPA %}SPA {% endif %}
                    {% if record.new_SPB %}SPB {% endif %}
                    {% if record.new_SPC %}SPC {% endif %}
                    {% if record.new_SPD %}SPD {% endif %}
                    {% if record.new_SPE %}SPE {% endif %}
                    {% if record.new_SPF %}SPF {% endif %}
                </td>
                <td>
                    {% if record.old_EFA %}EFA {% endif %}
                    {% if record.old_EFB %}EFB {% endif %}
                    {% if record.old_EFC %}EFC {% endif %}
                    {% if record.old_EFD %}EFD {% endif %}
                </td>
                <td>
                    {% if record.new_EFA %}EFA {% endif %}
                    {% if record.new_EFB %}EFB {% endif %}
                    {% if record.new_EFC %}EFC {% endif %}
                    {% if record.new_EFD %}EFD {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <a href="{{ url_for('home') }}" class="btn btn-warning">Go Back</a>
</div>
</body>
</html>
